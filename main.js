!function(){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,n(o.key),o)}}function n(t){var n=function(t){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(n)?n:n+""}var r=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._selector=t,this._popupElement=document.querySelector(this._selector),this._closeButton=this._popupElement.querySelector(".popup__container-close-button")},(n=[{key:"open",value:function(){this._popupElement.classList.add("popup__opened")}},{key:"close",value:function(){this._popupElement.classList.remove("popup__opened")}},{key:"_handleEscClose",value:function(e){"Escape"===e.key&&this._popupElement.classList.remove("popup__opened")}},{key:"setEventListeners",value:function(){var e=this;this._closeButton.addEventListener("click",(function(){e.close()})),document.addEventListener("keydown",(function(t){e._handleEscClose(t)}))}}])&&t(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n}();function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function i(e,t,n){return t=c(t),function(e,t){if(t&&("object"==o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,u()?Reflect.construct(t,n||[],c(e).constructor):t.apply(e,n))}function u(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(u=function(){return!!e})()}function c(e){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},c(e)}function a(e,t){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},a(e,t)}var l=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i(this,t,[e])}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}(t,e),n=t,Object.defineProperty(n,"prototype",{writable:!1}),n;var n}(r);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,p(r.key),r)}}function p(e){var t=function(e){if("object"!=s(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=s(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==s(t)?t:t+""}var y=function(){return e=function e(t,n,r,o,i,u,c,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._item=t,this._title=n,this._imageLink=r,this._likesQuantity=o,this._selector=i,this._handleCardClick=u,this._handleLikeQuantity=c,this._handleCardDelete=a},(t=[{key:"_getTemplate",value:function(){return document.querySelector(this._selector).content.querySelector(".element").cloneNode(!0)}},{key:"setLikesQuantity",value:function(e){this._likesQuantity=e,this._element.querySelector(".element__likes-quantity").textContent=this._likesQuantity}},{key:"handleLike",value:function(e){var t=e.target.classList.contains("inactive-icon"),n=e.target.classList.contains("active-icon");return t?(e.target.style.display="none",e.target.nextElementSibling.style.display="inline",!0):n?(e.target.style.display="none",e.target.previousElementSibling.style.display="inline",!1):void 0}},{key:"_closePopupImage",value:function(e){var t=document.querySelector("#image-popup");"Escape"!==e.key&&"click"!==e.type||t.classList.remove("popup__opened")}},{key:"trashCan",value:function(e,t){e!==t&&this._element.querySelector(".trash-can-icon").classList.add("dark-icon")}},{key:"_setEventListeners",value:function(){var e=this;this._element.querySelector(".element__image").addEventListener("click",this._handleCardClick),document.querySelector("#image-close-button").addEventListener("click",(function(t){e._closePopupImage(t)})),document.addEventListener("keydown",(function(t){e._closePopupImage(t)})),this._element.querySelector(".inactive-icon").addEventListener("click",(function(t){return e._handleLikeQuantity(t)})),this._element.querySelector(".active-icon").addEventListener("click",(function(t){return e._handleLikeQuantity(t)}));var t=new l("#confirmation-popup"),n=document.querySelector("#confirmation-button");this._element.querySelector(".trash-can-icon").addEventListener("click",(function(){t.open(),n.addEventListener("click",(function(){"61deba0ec5525e755b8d1397"===e._item.owner._id&&(e._handleCardDelete(e._item._id),e._element.remove(),t.close())}))})),t.setEventListeners()}},{key:"generateCard",value:function(){var e,t=this,n=document.querySelector(".elements");this._element=this._getTemplate(),this._setEventListeners(),this._element.querySelector(".element__image").src=this._imageLink,this._element.querySelector(".element__image").alt=this._title,this._element.querySelector(".element__title").textContent=this._title,this._element.querySelector(".element__likes-quantity").textContent=this._likesQuantity;var r=this._element.querySelector(".active-icon"),o=this._element.querySelector(".inactive-icon");(null===(e=this._item.likes)||void 0===e?void 0:e.some((function(e){return e._id===t._item.owner._id})))&&(r.classList.remove("dark-icon"),o.classList.add("dark-icon")),n.prepend(this._element)}}])&&f(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,d(r.key),r)}}function d(e){var t=function(e){if("object"!=m(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=m(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==m(t)?t:t+""}function b(e,t,n){return t=S(t),function(e,t){if(t&&("object"==m(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,h()?Reflect.construct(t,n||[],S(e).constructor):t.apply(e,n))}function h(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(h=function(){return!!e})()}function _(){return _="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=S(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},_.apply(null,arguments)}function S(e){return S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},S(e)}function g(e,t){return g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},g(e,t)}var k=function(e){function t(e,n,r){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=b(this,t,[r]))._titleElement=e,o._imageElement=n,o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g(e,t)}(t,e),n=t,r=[{key:"open",value:function(e,n){var r,o,i;(r=t,o=this,i=_(S(1&3?r.prototype:r),"open",o),function(e){return i.apply(o,e)})([]),this._imageElement.src=n,this._titleElement.textContent=e}}],r&&v(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(r);function E(e){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E(e)}function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,j(r.key),r)}}function j(e){var t=function(e){if("object"!=E(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=E(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==E(t)?t:t+""}function L(e,t,n){return t=q(t),function(e,t){if(t&&("object"==E(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,P()?Reflect.construct(t,n||[],q(e).constructor):t.apply(e,n))}function P(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(P=function(){return!!e})()}function O(e,t,n,r){var o=C(q(1&r?e.prototype:e),t,n);return 2&r?function(e){return o.apply(n,e)}:o}function C(){return C="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=q(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},C.apply(null,arguments)}function q(e){return q=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},q(e)}function T(e,t){return T=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},T(e,t)}var I=function(e){function t(e,n,r){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=L(this,t,[n]))._submitForm=e,o._submitButton=o._popupElement.querySelector(r),o._buttonMessage=o._submitButton.textContent,o._isLoading=!1,o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&T(e,t)}(t,e),n=t,(r=[{key:"_getInputValues",value:function(){var e=document.querySelector(this._selector).children[0][1],t=document.querySelector(this._selector).children[0][2];return[e.value,t.value]}},{key:"setLoading",value:function(){this._isLoading=!this._isLoading,this._isLoading?this._submitButton.textContent="Salvando...":this._submitButton.textContent=this._buttonMessage}},{key:"setEventListeners",value:function(){this._popupElement.addEventListener("submit",this._submitForm),O(t,"setEventListeners",this,3)([])}},{key:"close",value:function(){O(t,"close",this,3)([]);var e=document.querySelector(this._selector).children[0][1],n=document.querySelector(this._selector).children[0][2];e.value=this._getInputValues()[0],n.value=this._getInputValues()[1]}}])&&w(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(r);function R(e){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R(e)}function U(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,B(r.key),r)}}function B(e){var t=function(e){if("object"!=R(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=R(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==R(t)?t:t+""}var x=function(){return e=function e(t){var n=t.nameSelector,r=t.aboutSelector,o=t.avatarSelector;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._nameElement=document.querySelector(n),this._aboutElement=document.querySelector(r),this._avatarElement=document.querySelector(o)},(t=[{key:"getUserInfo",value:function(){return{userName:this._nameElement.textContent,userAbout:this._aboutElement.textContent}}},{key:"setUserInfo",value:function(e){var t=e.name,n=e.about;this._nameElement.textContent=t,this._aboutElement.textContent=n}},{key:"getAvatar",value:function(){return this._avatarElement.src}},{key:"setAvatar",value:function(e){this._avatarElement.src=e}}])&&U(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function D(e){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},D(e)}function A(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Q(r.key),r)}}function Q(e){var t=function(e){if("object"!=D(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=D(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==D(t)?t:t+""}var V=function(){return e=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._input=t.input,this._submitButton=t.submitButton,this._inactiveButton=t.inactiveButton,this._inputError=t.inputError,this._errorClass=t.errorClass,this._form=n},(t=[{key:"_showInputError",value:function(e,t,n){var r=e.querySelector(".".concat(t.id,"-error"));t.classList.add("popup__container-input_type-error"),r.textContent=n,r.classList.add("popup__container-error_active")}},{key:"_hideInputError",value:function(e,t){var n=e.querySelector(".".concat(t.id,"-error"));t.classList.remove("popup__container-input_type-error"),n.classList.remove("popup__container-error_active"),n.textContent=""}},{key:"_checkInputValidity",value:function(e,t){t.validity.valid?this._hideInputError(e,t):this._showInputError(e,t,t.validationMessage)}},{key:"_hasInvalidInput",value:function(e){return e.some((function(e){return!e.validity.valid}))}},{key:"_buttonState",value:function(e,t){this._hasInvalidInput(e)?(t.disabled=!0,t.classList.add("popup__container-button_inactive")):(t.disabled=!1,t.classList.remove("popup__container-button_inactive"))}},{key:"_setEventListeners",value:function(e){var t=this,n=Array.from(e.querySelectorAll(".popup__container-input")),r=e.querySelector(".popup__container-button");this._buttonState(n,r),n.forEach((function(o){o.addEventListener("input",(function(){t._checkInputValidity(e,o),t._buttonState(n,r)}))}))}},{key:"enableValidation",value:function(){var e=this._form;this._setEventListeners(e)}}])&&A(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function N(e){return N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},N(e)}function J(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,M(r.key),r)}}function M(e){var t=function(e){if("object"!=N(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=N(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==N(t)?t:t+""}var F=function(){return e=function e(t,n){var r=t.items,o=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._items=r,this._renderer=o,this._selector=document.querySelector(n)},(t=[{key:"renderer",value:function(){var e=this;this._items.forEach((function(t){e._renderer(t)}))}},{key:"addItem",value:function(e){this._selector.prepend(e)}}])&&J(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function H(e){return H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},H(e)}function z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,G(r.key),r)}}function G(e){var t=function(e){if("object"!=H(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=H(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==H(t)?t:t+""}var K=new(function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._baseURL=t.baseUrl,this._headers=t.headers},(t=[{key:"getUserInfo",value:function(){return fetch("".concat(this._baseURL,"/users/me"),{headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"editProfile",value:function(e,t){return fetch("".concat(this._baseURL,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:"".concat(e),about:"".concat(t)})}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"getInitialCards",value:function(){return fetch("".concat(this._baseURL,"/cards"),{headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"addCard",value:function(e,t){return fetch("".concat(this._baseURL,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:"".concat(e),link:"".concat(t)})}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"toLike",value:function(e){return fetch("".concat(this._baseURL,"/cards/likes/").concat(e),{method:"PUT",headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"toDislike",value:function(e){return fetch("".concat(this._baseURL,"/cards/likes/").concat(e),{method:"DELETE",headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"deleteCard",value:function(e){return fetch("".concat(this._baseURL,"/cards/").concat(e),{method:"DELETE",headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"updateAvatar",value:function(e){return fetch("".concat(this._baseURL,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:"".concat(e)})}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}}])&&z(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}())({baseUrl:"https://around.nomoreparties.co/v1/web-ptbr-cohort-12",headers:{authorization:"ff7f8eb8-527b-4454-9ba9-18449ff2bb6e","Content-Type":"application/json"}}),W=document.querySelector("#form-create"),X=document.querySelector("#form-edit"),Y=document.querySelector(".popup__image"),Z=document.querySelector(".popup__image-description"),$=document.querySelector(".profile__edit-button"),ee=document.querySelector(".profile__add-button"),te=document.querySelector(".profile__image-container"),ne=document.querySelectorAll(".popup"),re=new x({nameSelector:".profile__name",aboutSelector:".profile__about",avatarSelector:".profile__image"}),oe="61deba0ec5525e755b8d1397";K.getUserInfo().then((function(e){re.setUserInfo(e),re.setAvatar(e.avatar)})),K.getInitialCards().then((function(e){var t=new F({items:e.reverse(),renderer:function(e){var n=new k(Z,Y,"#image-popup"),r=new y(e,e.name,e.link,e.likes.length,"#elements-template",(function(){return n.open(e.name,e.link)}),(function(t){r.handleLike(t)?K.toLike(e._id).then((function(e){var t=e.likes;r.setLikesQuantity(t.length)})):K.toDislike(e._id).then((function(e){var t=e.likes;r.setLikesQuantity(t.length)}))}),(function(e){K.deleteCard(e)})),o=r.generateCard();r.trashCan(oe,e.owner._id),t.addItem(o)}},"#elements-template");t.renderer()}));var ie=new V({input:".popup__container-input",submitButton:".popup__container-button",inactiveButton:".popup__container-button_inactive",inputError:".popup__container-input_type-error",errorClass:".popup__container-error_active"},X),ue=new V({input:".popup__container-input",submitButton:".popup__container-button",inactiveButton:".popup__container-button_inactive",inputError:".popup__container-input_type-error",errorClass:".popup__container-error_active"},W);ie.enableValidation(),ue.enableValidation();var ce=new I((function(e){e.preventDefault(),ce.setLoading();var t=document.querySelector("#name").value,n=document.querySelector("#job").value;K.editProfile(t,n).then((function(){re.setUserInfo(t,n),K.getUserInfo().then((function(e){re.setUserInfo(e),re.getUserInfo()})),ce.setLoading(),ce.close()}))}),"#edit-popup",".popup__container-button"),ae=new I((function(e){e.preventDefault(),ae.setLoading();var t=document.querySelector("#title").value,n=document.querySelector("#image-link").value;K.addCard(t,n).then((function(e){var r=new k(Z,Y,"#image-popup"),o=new y(e,t,n,"0","#elements-template",(function(){return r.open(t,n)}),(function(t){o.handleLike(t)?K.toLike(e._id).then((function(e){var t=e.likes;o.setLikesQuantity(t.length)})):K.toDislike(e._id).then((function(e){var t=e.likes;o.setLikesQuantity(t.length)}))}),(function(e){K.deleteCard(e)}));ae.setLoading(),o.generateCard(),o.trashCan(oe,e.owner._id),ae.close()}))}),"#create-popup",".popup__container-button"),le=new I((function(e){e.preventDefault(),le.setLoading();var t=document.querySelector("#avatar-link").value;K.updateAvatar(t).then((function(){re.setAvatar(t),le.setLoading(),le.close()}))}),"#avatar-popup",".popup__container-button");ce.setEventListeners(),ae.setEventListeners(),le.setEventListeners(),$.addEventListener("click",(function(){ce.open()})),ee.addEventListener("click",(function(){ae.open()})),te.addEventListener("click",(function(){le.open()})),ne.forEach((function(e){e.addEventListener("click",(function(e){e.currentTarget===e.target&&e.currentTarget.classList.remove("popup__opened")}))}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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R0FDM0JBLEVBQUlrTSxnQkFBa0JsTSxFQUFJNkIsUUFDNUI3QixFQUFJa00sY0FBY3JNLFVBQVVFLE9BQU8sZ0JBRXZDLEdBQ0YsRyIsInNvdXJjZXMiOlsid2VicGFjazovL3dlYl9wcm9qZWN0X2Fyb3VuZC8uL3NyYy9zY3JpcHRzL1BvcHVwLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0X2Fyb3VuZC8uL3NyYy9zY3JpcHRzL1BvcHVwV2l0aENvbmZpcm1hdGlvbi5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF9hcm91bmQvLi9zcmMvc2NyaXB0cy9DYXJkLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0X2Fyb3VuZC8uL3NyYy9zY3JpcHRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0X2Fyb3VuZC8uL3NyYy9zY3JpcHRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfYXJvdW5kLy4vc3JjL3NjcmlwdHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfYXJvdW5kLy4vc3JjL3NjcmlwdHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF9hcm91bmQvLi9zcmMvc2NyaXB0cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0X2Fyb3VuZC8uL3NyYy9zY3JpcHRzL0FwaS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF9hcm91bmQvLi9zcmMvc2NyaXB0cy9zY3JpcHQuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9zZWxlY3RvciA9IHNlbGVjdG9yO1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9zZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9jbG9zZUJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBcIi5wb3B1cF9fY29udGFpbmVyLWNsb3NlLWJ1dHRvblwiXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgb3BlbigpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwicG9wdXBfX29wZW5lZFwiKTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9fb3BlbmVkXCIpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUVzY0Nsb3NlKGV2dCkge1xyXG4gICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9fb3BlbmVkXCIpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9jbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKGV2dCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhDb25maXJtYXRpb24gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3Ioc2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHNlbGVjdG9yKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwV2l0aENvbmZpcm1hdGlvbiBmcm9tIFwiLi9Qb3B1cFdpdGhDb25maXJtYXRpb24uanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgaXRlbSxcclxuICAgIHRpdGxlLFxyXG4gICAgaW1hZ2VMaW5rLFxyXG4gICAgbGlrZXNRdWFudGl0eSxcclxuICAgIHNlbGVjdG9yLFxyXG4gICAgaGFuZGxlQ2FyZENsaWNrLFxyXG4gICAgaGFuZGxlTGlrZVF1YW50aXR5LFxyXG4gICAgaGFuZGxlQ2FyZERlbGV0ZVxyXG4gICkge1xyXG4gICAgdGhpcy5faXRlbSA9IGl0ZW07XHJcbiAgICB0aGlzLl90aXRsZSA9IHRpdGxlO1xyXG4gICAgdGhpcy5faW1hZ2VMaW5rID0gaW1hZ2VMaW5rO1xyXG4gICAgdGhpcy5fbGlrZXNRdWFudGl0eSA9IGxpa2VzUXVhbnRpdHk7XHJcbiAgICB0aGlzLl9zZWxlY3RvciA9IHNlbGVjdG9yO1xyXG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xyXG4gICAgdGhpcy5faGFuZGxlTGlrZVF1YW50aXR5ID0gaGFuZGxlTGlrZVF1YW50aXR5O1xyXG4gICAgdGhpcy5faGFuZGxlQ2FyZERlbGV0ZSA9IGhhbmRsZUNhcmREZWxldGU7XHJcbiAgfVxyXG5cclxuICBfZ2V0VGVtcGxhdGUoKSB7XHJcbiAgICBjb25zdCBlbGVtZW50ID0gZG9jdW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fc2VsZWN0b3IpXHJcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudFwiKVxyXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG5cclxuICAgIHJldHVybiBlbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgc2V0TGlrZXNRdWFudGl0eShsaWtlc1F1YW50aXR5KSB7XHJcbiAgICB0aGlzLl9saWtlc1F1YW50aXR5ID0gbGlrZXNRdWFudGl0eTtcclxuICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19saWtlcy1xdWFudGl0eVwiKS50ZXh0Q29udGVudCA9XHJcbiAgICAgIHRoaXMuX2xpa2VzUXVhbnRpdHk7XHJcbiAgfVxyXG5cclxuICBoYW5kbGVMaWtlKGV2dCkge1xyXG4gICAgY29uc3QgaW5hY3RpdmVJY29uID0gZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJpbmFjdGl2ZS1pY29uXCIpO1xyXG4gICAgY29uc3QgYWN0aXZlSWNvbiA9IGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwiYWN0aXZlLWljb25cIik7XHJcblxyXG4gICAgaWYgKGluYWN0aXZlSWNvbikge1xyXG4gICAgICBldnQudGFyZ2V0LnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcclxuICAgICAgZXZ0LnRhcmdldC5uZXh0RWxlbWVudFNpYmxpbmcuc3R5bGUuZGlzcGxheSA9IFwiaW5saW5lXCI7XHJcbiAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfSBlbHNlIGlmIChhY3RpdmVJY29uKSB7XHJcbiAgICAgIGV2dC50YXJnZXQuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG4gICAgICBldnQudGFyZ2V0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcuc3R5bGUuZGlzcGxheSA9IFwiaW5saW5lXCI7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9jbG9zZVBvcHVwSW1hZ2UoZXZ0KSB7XHJcbiAgICBjb25zdCBwb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjaW1hZ2UtcG9wdXBcIik7XHJcblxyXG4gICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIgfHwgZXZ0LnR5cGUgPT09IFwiY2xpY2tcIikge1xyXG4gICAgICBwb3B1cC5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfX29wZW5lZFwiKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHRyYXNoQ2FuKHVzZXJJZCwgY2FyZE93bmVySWQpIHtcclxuICAgIGlmICh1c2VySWQgIT09IGNhcmRPd25lcklkKSB7XHJcbiAgICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi50cmFzaC1jYW4taWNvblwiKS5jbGFzc0xpc3QuYWRkKFwiZGFyay1pY29uXCIpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fZWxlbWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19pbWFnZVwiKVxyXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZUNhcmRDbGljayk7XHJcblxyXG4gICAgZG9jdW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIjaW1hZ2UtY2xvc2UtYnV0dG9uXCIpXHJcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2Nsb3NlUG9wdXBJbWFnZShldnQpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIHRoaXMuX2Nsb3NlUG9wdXBJbWFnZShldnQpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5fZWxlbWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5pbmFjdGl2ZS1pY29uXCIpXHJcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4gdGhpcy5faGFuZGxlTGlrZVF1YW50aXR5KGV2dCkpO1xyXG5cclxuICAgIHRoaXMuX2VsZW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuYWN0aXZlLWljb25cIilcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB0aGlzLl9oYW5kbGVMaWtlUXVhbnRpdHkoZXZ0KSk7XHJcblxyXG4gICAgY29uc3QgY29uZmlybWF0aW9uID0gbmV3IFBvcHVwV2l0aENvbmZpcm1hdGlvbihcIiNjb25maXJtYXRpb24tcG9wdXBcIik7XHJcbiAgICBjb25zdCBjb25maXJtQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjb25maXJtYXRpb24tYnV0dG9uXCIpO1xyXG5cclxuICAgIHRoaXMuX2VsZW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIudHJhc2gtY2FuLWljb25cIilcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgY29uZmlybWF0aW9uLm9wZW4oKTtcclxuXHJcbiAgICAgICAgY29uZmlybUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgaWYgKHRoaXMuX2l0ZW0ub3duZXIuX2lkID09PSBcIjYxZGViYTBlYzU1MjVlNzU1YjhkMTM5N1wiKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZUNhcmREZWxldGUodGhpcy5faXRlbS5faWQpO1xyXG4gICAgICAgICAgICB0aGlzLl9lbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgICAgICAgICBjb25maXJtYXRpb24uY2xvc2UoKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgY29uZmlybWF0aW9uLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG5cclxuICBnZW5lcmF0ZUNhcmQoKSB7XHJcbiAgICBjb25zdCBlbGVtZW50c0NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudHNcIik7XHJcblxyXG4gICAgdGhpcy5fZWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19pbWFnZVwiKS5zcmMgPSB0aGlzLl9pbWFnZUxpbms7XHJcblxyXG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX2ltYWdlXCIpLmFsdCA9IHRoaXMuX3RpdGxlO1xyXG5cclxuICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X190aXRsZVwiKS50ZXh0Q29udGVudCA9IHRoaXMuX3RpdGxlO1xyXG5cclxuICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19saWtlcy1xdWFudGl0eVwiKS50ZXh0Q29udGVudCA9XHJcbiAgICAgIHRoaXMuX2xpa2VzUXVhbnRpdHk7XHJcblxyXG4gICAgY29uc3QgYWN0aXZlSWNvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5hY3RpdmUtaWNvblwiKTtcclxuICAgIGNvbnN0IGluYWN0aXZlSWNvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5pbmFjdGl2ZS1pY29uXCIpO1xyXG5cclxuICAgIGNvbnN0IGlzVXNlckxpa2VkID0gdGhpcy5faXRlbS5saWtlcz8uc29tZSgobGlrZSkgPT4ge1xyXG4gICAgICByZXR1cm4gbGlrZS5faWQgPT09IHRoaXMuX2l0ZW0ub3duZXIuX2lkO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaWYgKGlzVXNlckxpa2VkKSB7XHJcbiAgICAgIGFjdGl2ZUljb24uY2xhc3NMaXN0LnJlbW92ZShcImRhcmstaWNvblwiKTtcclxuICAgICAgaW5hY3RpdmVJY29uLmNsYXNzTGlzdC5hZGQoXCJkYXJrLWljb25cIik7XHJcbiAgICB9XHJcblxyXG4gICAgZWxlbWVudHNDb250YWluZXIucHJlcGVuZCh0aGlzLl9lbGVtZW50KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcih0aXRsZUVsZW1lbnQsIGltYWdlRWxlbWVudCwgc2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3RpdGxlRWxlbWVudCA9IHRpdGxlRWxlbWVudDtcclxuICAgIHRoaXMuX2ltYWdlRWxlbWVudCA9IGltYWdlRWxlbWVudDtcclxuICB9XHJcblxyXG4gIG9wZW4odGl0bGUsIGxpbmspIHtcclxuICAgIHN1cGVyLm9wZW4oKTtcclxuXHJcbiAgICB0aGlzLl9pbWFnZUVsZW1lbnQuc3JjID0gbGluaztcclxuICAgIHRoaXMuX3RpdGxlRWxlbWVudC50ZXh0Q29udGVudCA9IHRpdGxlO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcFVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3Ioc3VibWl0Rm9ybSwgc2VsZWN0b3IsIHN1Ym1pdEJ1dHRvbikge1xyXG4gICAgc3VwZXIoc2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fc3VibWl0Rm9ybSA9IHN1Ym1pdEZvcm07XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihzdWJtaXRCdXR0b24pO1xyXG4gICAgdGhpcy5fYnV0dG9uTWVzc2FnZSA9IHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudDtcclxuICAgIHRoaXMuX2lzTG9hZGluZyA9IGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgY29uc3QgZmlyc3RWYWx1ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fc2VsZWN0b3IpLmNoaWxkcmVuWzBdWzFdO1xyXG5cclxuICAgIGNvbnN0IHNlY29uZFZhbHVlID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9zZWxlY3RvcikuY2hpbGRyZW5bMF1bMl07XHJcblxyXG4gICAgY29uc3QgaW5wdXRWYWx1ZXMgPSBbZmlyc3RWYWx1ZS52YWx1ZSwgc2Vjb25kVmFsdWUudmFsdWVdO1xyXG5cclxuICAgIHJldHVybiBpbnB1dFZhbHVlcztcclxuICB9XHJcblxyXG4gIHNldExvYWRpbmcoKSB7XHJcbiAgICB0aGlzLl9pc0xvYWRpbmcgPSAhdGhpcy5faXNMb2FkaW5nO1xyXG5cclxuICAgIGlmICh0aGlzLl9pc0xvYWRpbmcpIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJTYWx2YW5kby4uLlwiO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gdGhpcy5fYnV0dG9uTWVzc2FnZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgdGhpcy5fc3VibWl0Rm9ybSk7XHJcblxyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgc3VwZXIuY2xvc2UoKTtcclxuXHJcbiAgICBjb25zdCBmaXJzdFZhbHVlID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9zZWxlY3RvcikuY2hpbGRyZW5bMF1bMV07XHJcblxyXG4gICAgY29uc3Qgc2Vjb25kVmFsdWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX3NlbGVjdG9yKS5jaGlsZHJlblswXVsyXTtcclxuXHJcbiAgICBmaXJzdFZhbHVlLnZhbHVlID0gdGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKVswXTtcclxuICAgIHNlY29uZFZhbHVlLnZhbHVlID0gdGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKVsxXTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xyXG4gIGNvbnN0cnVjdG9yKHsgbmFtZVNlbGVjdG9yLCBhYm91dFNlbGVjdG9yLCBhdmF0YXJTZWxlY3RvciB9KSB7XHJcbiAgICB0aGlzLl9uYW1lRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2Fib3V0RWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYWJvdXRTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9hdmF0YXJFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdmF0YXJTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIGNvbnN0IHVzZXJOYW1lID0gdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQ7XHJcbiAgICBjb25zdCB1c2VyQWJvdXQgPSB0aGlzLl9hYm91dEVsZW1lbnQudGV4dENvbnRlbnQ7XHJcblxyXG4gICAgcmV0dXJuIHsgdXNlck5hbWUsIHVzZXJBYm91dCB9O1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckluZm8oeyBuYW1lLCBhYm91dCB9KSB7XHJcbiAgICB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICB0aGlzLl9hYm91dEVsZW1lbnQudGV4dENvbnRlbnQgPSBhYm91dDtcclxuICB9XHJcblxyXG4gIGdldEF2YXRhcigpIHtcclxuICAgIGNvbnN0IHVzZXJBdmF0YXIgPSB0aGlzLl9hdmF0YXJFbGVtZW50LnNyYztcclxuXHJcbiAgICByZXR1cm4gdXNlckF2YXRhcjtcclxuICB9XHJcblxyXG4gIHNldEF2YXRhcihhdmF0YXIpIHtcclxuICAgIHRoaXMuX2F2YXRhckVsZW1lbnQuc3JjID0gYXZhdGFyO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICAgIGNvbnN0cnVjdG9yKGNvbmZpZywgZm9ybSkge1xyXG4gICAgICB0aGlzLl9pbnB1dCA9IGNvbmZpZy5pbnB1dDtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uID0gY29uZmlnLnN1Ym1pdEJ1dHRvbjtcclxuICAgICAgdGhpcy5faW5hY3RpdmVCdXR0b24gPSBjb25maWcuaW5hY3RpdmVCdXR0b247XHJcbiAgICAgIHRoaXMuX2lucHV0RXJyb3IgPSBjb25maWcuaW5wdXRFcnJvcjtcclxuICAgICAgdGhpcy5fZXJyb3JDbGFzcyA9IGNvbmZpZy5lcnJvckNsYXNzO1xyXG4gICAgICB0aGlzLl9mb3JtID0gZm9ybTtcclxuICAgIH1cclxuICBcclxuICAgIF9zaG93SW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXQsIGVycm9yTWVzc2FnZSkge1xyXG4gICAgICBjb25zdCBlcnJvckVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dC5pZH0tZXJyb3JgKTtcclxuICBcclxuICAgICAgaW5wdXQuY2xhc3NMaXN0LmFkZChcInBvcHVwX19jb250YWluZXItaW5wdXRfdHlwZS1lcnJvclwiKTtcclxuICBcclxuICAgICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xyXG4gICAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInBvcHVwX19jb250YWluZXItZXJyb3JfYWN0aXZlXCIpO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgX2hpZGVJbnB1dEVycm9yKGZvcm1FbGVtZW50LCBpbnB1dCkge1xyXG4gICAgICBjb25zdCBlcnJvckVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dC5pZH0tZXJyb3JgKTtcclxuICAgICAgaW5wdXQuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwX19jb250YWluZXItaW5wdXRfdHlwZS1lcnJvclwiKTtcclxuICAgICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9fY29udGFpbmVyLWVycm9yX2FjdGl2ZVwiKTtcclxuICAgICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcclxuICAgIH1cclxuICBcclxuICAgIF9jaGVja0lucHV0VmFsaWRpdHkoZm9ybUVsZW1lbnQsIGlucHV0KSB7XHJcbiAgICAgIGlmICghaW5wdXQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXQsIGlucHV0LnZhbGlkYXRpb25NZXNzYWdlKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXQpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgXHJcbiAgICBfaGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkge1xyXG4gICAgICByZXR1cm4gaW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICAgIHJldHVybiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICBcclxuICAgIF9idXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbikge1xyXG4gICAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkpIHtcclxuICAgICAgICBidXR0b24uZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgICAgIGJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwicG9wdXBfX2NvbnRhaW5lci1idXR0b25faW5hY3RpdmVcIik7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgYnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICAgICAgYnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9fY29udGFpbmVyLWJ1dHRvbl9pbmFjdGl2ZVwiKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIFxyXG4gICAgX3NldEV2ZW50TGlzdGVuZXJzKGZvcm1FbGVtZW50KSB7XHJcbiAgICAgIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oXHJcbiAgICAgICAgZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5wb3B1cF9fY29udGFpbmVyLWlucHV0XCIpXHJcbiAgICAgICk7XHJcbiAgXHJcbiAgICAgIGNvbnN0IGJ1dHRvbiA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2NvbnRhaW5lci1idXR0b25cIik7XHJcbiAgXHJcbiAgICAgIHRoaXMuX2J1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uKTtcclxuICBcclxuICAgICAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcclxuICAgICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShmb3JtRWxlbWVudCwgaW5wdXQpO1xyXG4gICAgICAgICAgdGhpcy5fYnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b24pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICBcclxuICAgIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICAgIGNvbnN0IGZvcm0gPSB0aGlzLl9mb3JtO1xyXG4gIFxyXG4gICAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycyhmb3JtKTtcclxuICAgIH1cclxuICB9XHJcbiAgIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgc2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XHJcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgdGhpcy5fc2VsZWN0b3IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIHJlbmRlcmVyKCkge1xyXG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICB0aGlzLl9zZWxlY3Rvci5wcmVwZW5kKGVsZW1lbnQpO1xyXG4gIH1cclxufVxyXG4iLCJjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcclxuICAgIHRoaXMuX2Jhc2VVUkwgPSBvcHRpb25zLmJhc2VVcmw7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gb3B0aW9ucy5oZWFkZXJzO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVSTH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGVkaXRQcm9maWxlKG5hbWUsIGFib3V0KSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVSTH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZTogYCR7bmFtZX1gLFxyXG4gICAgICAgIGFib3V0OiBgJHthYm91dH1gLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVUkx9L2NhcmRzYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBhZGRDYXJkKG5hbWUsIGxpbmspIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVVJMfS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWU6IGAke25hbWV9YCxcclxuICAgICAgICBsaW5rOiBgJHtsaW5rfWAsXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICB0b0xpa2UoaWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVVJMfS9jYXJkcy9saWtlcy8ke2lkfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICB0b0Rpc2xpa2UoaWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVVJMfS9jYXJkcy9saWtlcy8ke2lkfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBkZWxldGVDYXJkKGlkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVSTH0vY2FyZHMvJHtpZH1gLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlQXZhdGFyKGF2YXRhcikge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVUkx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBhdmF0YXI6IGAke2F2YXRhcn1gLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG5cclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL3dlYi1wdGJyLWNvaG9ydC0xMlwiLFxyXG4gIGhlYWRlcnM6IHtcclxuICAgIGF1dGhvcml6YXRpb246IFwiZmY3ZjhlYjgtNTI3Yi00NDU0LTliYTktMTg0NDlmZjJiYjZlXCIsXHJcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICB9LFxyXG59KTtcclxuXHJcbmV4cG9ydCB7IGFwaSB9O1xyXG4iLCJpbXBvcnQgXCIuLi9wYWdlcy9pbmRleC5jc3NcIjtcclxuaW1wb3J0IENhcmQgZnJvbSBcIi4vQ2FyZC5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4vUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IFBvcFVwV2l0aEZvcm0gZnJvbSBcIi4vUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4vVXNlckluZm8uanNcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4vRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCB7IGFwaSB9IGZyb20gXCIuL0FwaS5qc1wiO1xyXG5cclxuY29uc3QgZm9ybUNyZWF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZm9ybS1jcmVhdGVcIik7XHJcbmNvbnN0IGZvcm1FZGl0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNmb3JtLWVkaXRcIik7XHJcbmNvbnN0IGltYWdlRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2ltYWdlXCIpO1xyXG5jb25zdCB0aXRsZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbWFnZS1kZXNjcmlwdGlvblwiKTtcclxuY29uc3QgZWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1idXR0b25cIik7XHJcbmNvbnN0IGFkZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcclxuY29uc3QgcHJvZmlsZUltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19pbWFnZS1jb250YWluZXJcIik7XHJcbmNvbnN0IHBvcHVwcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucG9wdXBcIik7XHJcblxyXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XHJcbiAgbmFtZVNlbGVjdG9yOiBcIi5wcm9maWxlX19uYW1lXCIsXHJcbiAgYWJvdXRTZWxlY3RvcjogXCIucHJvZmlsZV9fYWJvdXRcIixcclxuICBhdmF0YXJTZWxlY3RvcjogXCIucHJvZmlsZV9faW1hZ2VcIixcclxufSk7XHJcblxyXG5jb25zdCB1c2VyRGF0YSA9IFwiNjFkZWJhMGVjNTUyNWU3NTViOGQxMzk3XCI7XHJcblxyXG5hcGkuZ2V0VXNlckluZm8oKS50aGVuKChkYXRhKSA9PiB7XHJcbiAgdXNlckluZm8uc2V0VXNlckluZm8oZGF0YSk7XHJcbiAgdXNlckluZm8uc2V0QXZhdGFyKGRhdGEuYXZhdGFyKTtcclxufSk7XHJcblxyXG5hcGkuZ2V0SW5pdGlhbENhcmRzKCkudGhlbigoZGF0YSkgPT4ge1xyXG4gIGNvbnN0IGNhcmRMaXN0ID0gbmV3IFNlY3Rpb24oXHJcbiAgICB7XHJcbiAgICAgIGl0ZW1zOiBkYXRhLnJldmVyc2UoKSxcclxuICAgICAgcmVuZGVyZXI6IChpdGVtKSA9PiB7XHJcbiAgICAgICAgY29uc3QgcG9wdXBJbWFnZSA9IG5ldyBQb3B1cFdpdGhJbWFnZShcclxuICAgICAgICAgIHRpdGxlRWxlbWVudCxcclxuICAgICAgICAgIGltYWdlRWxlbWVudCxcclxuICAgICAgICAgIFwiI2ltYWdlLXBvcHVwXCJcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICBjb25zdCBjYXJkID0gbmV3IENhcmQoXHJcbiAgICAgICAgICBpdGVtLFxyXG4gICAgICAgICAgaXRlbS5uYW1lLFxyXG4gICAgICAgICAgaXRlbS5saW5rLFxyXG4gICAgICAgICAgaXRlbS5saWtlcy5sZW5ndGgsXHJcbiAgICAgICAgICBcIiNlbGVtZW50cy10ZW1wbGF0ZVwiLFxyXG4gICAgICAgICAgKCkgPT4gcG9wdXBJbWFnZS5vcGVuKGl0ZW0ubmFtZSwgaXRlbS5saW5rKSxcclxuXHJcbiAgICAgICAgICAoZXZ0KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGlzTGlrZWQgPSBjYXJkLmhhbmRsZUxpa2UoZXZ0KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChpc0xpa2VkKSB7XHJcbiAgICAgICAgICAgICAgYXBpLnRvTGlrZShpdGVtLl9pZCkudGhlbigocmVzcG9uc2UpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGRhdGEgPSByZXNwb25zZS5saWtlcztcclxuICAgICAgICAgICAgICAgIGNhcmQuc2V0TGlrZXNRdWFudGl0eShkYXRhLmxlbmd0aCk7XHJcbiAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgYXBpLnRvRGlzbGlrZShpdGVtLl9pZCkudGhlbigocmVzcG9uc2UpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGRhdGEgPSByZXNwb25zZS5saWtlcztcclxuICAgICAgICAgICAgICAgIGNhcmQuc2V0TGlrZXNRdWFudGl0eShkYXRhLmxlbmd0aCk7XHJcbiAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgKGNhcmRJZCkgPT4ge1xyXG4gICAgICAgICAgICBhcGkuZGVsZXRlQ2FyZChjYXJkSWQpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZC5nZW5lcmF0ZUNhcmQoKTtcclxuXHJcbiAgICAgICAgY2FyZC50cmFzaENhbih1c2VyRGF0YSwgaXRlbS5vd25lci5faWQpO1xyXG5cclxuICAgICAgICBjYXJkTGlzdC5hZGRJdGVtKGNhcmRFbGVtZW50KTtcclxuICAgICAgfSxcclxuICAgIH0sXHJcbiAgICBcIiNlbGVtZW50cy10ZW1wbGF0ZVwiXHJcbiAgKTtcclxuXHJcbiAgY2FyZExpc3QucmVuZGVyZXIoKTtcclxufSk7XHJcblxyXG5jb25zdCBmb3JtRWRpdFZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxyXG4gIHtcclxuICAgIGlucHV0OiBcIi5wb3B1cF9fY29udGFpbmVyLWlucHV0XCIsXHJcbiAgICBzdWJtaXRCdXR0b246IFwiLnBvcHVwX19jb250YWluZXItYnV0dG9uXCIsXHJcbiAgICBpbmFjdGl2ZUJ1dHRvbjogXCIucG9wdXBfX2NvbnRhaW5lci1idXR0b25faW5hY3RpdmVcIixcclxuICAgIGlucHV0RXJyb3I6IFwiLnBvcHVwX19jb250YWluZXItaW5wdXRfdHlwZS1lcnJvclwiLFxyXG4gICAgZXJyb3JDbGFzczogXCIucG9wdXBfX2NvbnRhaW5lci1lcnJvcl9hY3RpdmVcIixcclxuICB9LFxyXG4gIGZvcm1FZGl0XHJcbik7XHJcblxyXG5jb25zdCBmb3JtQ3JlYXRlVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXHJcbiAge1xyXG4gICAgaW5wdXQ6IFwiLnBvcHVwX19jb250YWluZXItaW5wdXRcIixcclxuICAgIHN1Ym1pdEJ1dHRvbjogXCIucG9wdXBfX2NvbnRhaW5lci1idXR0b25cIixcclxuICAgIGluYWN0aXZlQnV0dG9uOiBcIi5wb3B1cF9fY29udGFpbmVyLWJ1dHRvbl9pbmFjdGl2ZVwiLFxyXG4gICAgaW5wdXRFcnJvcjogXCIucG9wdXBfX2NvbnRhaW5lci1pbnB1dF90eXBlLWVycm9yXCIsXHJcbiAgICBlcnJvckNsYXNzOiBcIi5wb3B1cF9fY29udGFpbmVyLWVycm9yX2FjdGl2ZVwiLFxyXG4gIH0sXHJcbiAgZm9ybUNyZWF0ZVxyXG4pO1xyXG5cclxuZm9ybUVkaXRWYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5mb3JtQ3JlYXRlVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbmNvbnN0IHBvcHVwRm9ybUVkaXQgPSBuZXcgUG9wVXBXaXRoRm9ybShcclxuICBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdCxcclxuICBcIiNlZGl0LXBvcHVwXCIsXHJcbiAgXCIucG9wdXBfX2NvbnRhaW5lci1idXR0b25cIlxyXG4pO1xyXG5cclxuY29uc3QgcG9wdXBGb3JtQ3JlYXRlID0gbmV3IFBvcFVwV2l0aEZvcm0oXHJcbiAgaGFuZGxlRWxlbWVudEZvcm1TdWJtaXQsXHJcbiAgXCIjY3JlYXRlLXBvcHVwXCIsXHJcbiAgXCIucG9wdXBfX2NvbnRhaW5lci1idXR0b25cIlxyXG4pO1xyXG5cclxuY29uc3QgcG9wdXBGb3JtQXZhdGFyID0gbmV3IFBvcFVwV2l0aEZvcm0oXHJcbiAgaGFuZGxlQXZhdGFyVXBkYXRlLFxyXG4gIFwiI2F2YXRhci1wb3B1cFwiLFxyXG4gIFwiLnBvcHVwX19jb250YWluZXItYnV0dG9uXCJcclxuKTtcclxuXHJcbnBvcHVwRm9ybUVkaXQuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxucG9wdXBGb3JtQ3JlYXRlLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbnBvcHVwRm9ybUF2YXRhci5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQoZXZ0KSB7XHJcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gIHBvcHVwRm9ybUVkaXQuc2V0TG9hZGluZygpO1xyXG5cclxuICBjb25zdCBuYW1lSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI25hbWVcIikudmFsdWU7XHJcbiAgY29uc3Qgam9iSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2pvYlwiKS52YWx1ZTtcclxuXHJcbiAgYXBpLmVkaXRQcm9maWxlKG5hbWVJbnB1dCwgam9iSW5wdXQpLnRoZW4oKCkgPT4ge1xyXG4gICAgdXNlckluZm8uc2V0VXNlckluZm8obmFtZUlucHV0LCBqb2JJbnB1dCk7XHJcbiAgICBhcGkuZ2V0VXNlckluZm8oKS50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKGRhdGEpO1xyXG4gICAgICB1c2VySW5mby5nZXRVc2VySW5mbygpO1xyXG4gICAgfSk7XHJcbiAgICBwb3B1cEZvcm1FZGl0LnNldExvYWRpbmcoKTtcclxuICAgIHBvcHVwRm9ybUVkaXQuY2xvc2UoKTtcclxuICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlRWxlbWVudEZvcm1TdWJtaXQoZXZ0KSB7XHJcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gIHBvcHVwRm9ybUNyZWF0ZS5zZXRMb2FkaW5nKCk7XHJcblxyXG4gIGNvbnN0IHRpdGxlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3RpdGxlXCIpLnZhbHVlO1xyXG4gIGNvbnN0IGltYWdlTGlua0lucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNpbWFnZS1saW5rXCIpLnZhbHVlO1xyXG5cclxuICBhcGkuYWRkQ2FyZCh0aXRsZUlucHV0LCBpbWFnZUxpbmtJbnB1dCkudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgY29uc3QgcG9wdXBJbWFnZSA9IG5ldyBQb3B1cFdpdGhJbWFnZShcclxuICAgICAgdGl0bGVFbGVtZW50LFxyXG4gICAgICBpbWFnZUVsZW1lbnQsXHJcbiAgICAgIFwiI2ltYWdlLXBvcHVwXCJcclxuICAgICk7XHJcblxyXG4gICAgY29uc3QgZWxlbWVudCA9IG5ldyBDYXJkKFxyXG4gICAgICBkYXRhLFxyXG4gICAgICB0aXRsZUlucHV0LFxyXG4gICAgICBpbWFnZUxpbmtJbnB1dCxcclxuICAgICAgXCIwXCIsXHJcbiAgICAgIFwiI2VsZW1lbnRzLXRlbXBsYXRlXCIsXHJcbiAgICAgICgpID0+IHBvcHVwSW1hZ2Uub3Blbih0aXRsZUlucHV0LCBpbWFnZUxpbmtJbnB1dCksXHJcblxyXG4gICAgICAoZXZ0KSA9PiB7XHJcbiAgICAgICAgY29uc3QgaXNMaWtlZCA9IGVsZW1lbnQuaGFuZGxlTGlrZShldnQpO1xyXG5cclxuICAgICAgICBpZiAoaXNMaWtlZCkge1xyXG4gICAgICAgICAgYXBpLnRvTGlrZShkYXRhLl9pZCkudGhlbigocmVzcG9uc2UpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgZGF0YSA9IHJlc3BvbnNlLmxpa2VzO1xyXG4gICAgICAgICAgICBlbGVtZW50LnNldExpa2VzUXVhbnRpdHkoZGF0YS5sZW5ndGgpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGFwaS50b0Rpc2xpa2UoZGF0YS5faWQpLnRoZW4oKHJlc3BvbnNlKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSByZXNwb25zZS5saWtlcztcclxuICAgICAgICAgICAgZWxlbWVudC5zZXRMaWtlc1F1YW50aXR5KGRhdGEubGVuZ3RoKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfSxcclxuXHJcbiAgICAgIChjYXJkSWQpID0+IHtcclxuICAgICAgICBhcGkuZGVsZXRlQ2FyZChjYXJkSWQpO1xyXG4gICAgICB9XHJcbiAgICApO1xyXG5cclxuICAgIHBvcHVwRm9ybUNyZWF0ZS5zZXRMb2FkaW5nKCk7XHJcblxyXG4gICAgZWxlbWVudC5nZW5lcmF0ZUNhcmQoKTtcclxuXHJcbiAgICBlbGVtZW50LnRyYXNoQ2FuKHVzZXJEYXRhLCBkYXRhLm93bmVyLl9pZCk7XHJcblxyXG4gICAgcG9wdXBGb3JtQ3JlYXRlLmNsb3NlKCk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUF2YXRhclVwZGF0ZShldnQpIHtcclxuICBldnQucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgcG9wdXBGb3JtQXZhdGFyLnNldExvYWRpbmcoKTtcclxuXHJcbiAgY29uc3QgYXZhdGFyTGluayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYXZhdGFyLWxpbmtcIikudmFsdWU7XHJcblxyXG4gIGFwaS51cGRhdGVBdmF0YXIoYXZhdGFyTGluaykudGhlbigoKSA9PiB7XHJcbiAgICB1c2VySW5mby5zZXRBdmF0YXIoYXZhdGFyTGluayk7XHJcbiAgICBwb3B1cEZvcm1BdmF0YXIuc2V0TG9hZGluZygpO1xyXG4gICAgcG9wdXBGb3JtQXZhdGFyLmNsb3NlKCk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbmVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBwb3B1cEZvcm1FZGl0Lm9wZW4oKTtcclxufSk7XHJcblxyXG5hZGRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBwb3B1cEZvcm1DcmVhdGUub3BlbigpO1xyXG59KTtcclxuXHJcbnByb2ZpbGVJbWFnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIHBvcHVwRm9ybUF2YXRhci5vcGVuKCk7XHJcbn0pO1xyXG5cclxucG9wdXBzLmZvckVhY2goKHBvcHVwKSA9PiB7XHJcbiAgcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcclxuICAgIGlmIChldnQuY3VycmVudFRhcmdldCA9PT0gZXZ0LnRhcmdldCkge1xyXG4gICAgICBldnQuY3VycmVudFRhcmdldC5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfX29wZW5lZFwiKTtcclxuICAgIH1cclxuICB9KTtcclxufSk7XHJcbiJdLCJuYW1lcyI6WyJQb3B1cCIsInNlbGVjdG9yIiwiX2NsYXNzQ2FsbENoZWNrIiwidGhpcyIsIl9zZWxlY3RvciIsIl9wb3B1cEVsZW1lbnQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJfY2xvc2VCdXR0b24iLCJrZXkiLCJ2YWx1ZSIsImNsYXNzTGlzdCIsImFkZCIsInJlbW92ZSIsImV2dCIsIl90aGlzIiwiYWRkRXZlbnRMaXN0ZW5lciIsImNsb3NlIiwiX2hhbmRsZUVzY0Nsb3NlIiwiUG9wdXBXaXRoQ29uZmlybWF0aW9uIiwiX1BvcHVwIiwiX2NhbGxTdXBlciIsIl9pbmhlcml0cyIsIkNhcmQiLCJpdGVtIiwidGl0bGUiLCJpbWFnZUxpbmsiLCJsaWtlc1F1YW50aXR5IiwiaGFuZGxlQ2FyZENsaWNrIiwiaGFuZGxlTGlrZVF1YW50aXR5IiwiaGFuZGxlQ2FyZERlbGV0ZSIsIl9pdGVtIiwiX3RpdGxlIiwiX2ltYWdlTGluayIsIl9saWtlc1F1YW50aXR5IiwiX2hhbmRsZUNhcmRDbGljayIsIl9oYW5kbGVMaWtlUXVhbnRpdHkiLCJfaGFuZGxlQ2FyZERlbGV0ZSIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJfZWxlbWVudCIsInRleHRDb250ZW50IiwiaW5hY3RpdmVJY29uIiwidGFyZ2V0IiwiY29udGFpbnMiLCJhY3RpdmVJY29uIiwic3R5bGUiLCJkaXNwbGF5IiwibmV4dEVsZW1lbnRTaWJsaW5nIiwicHJldmlvdXNFbGVtZW50U2libGluZyIsInBvcHVwIiwidHlwZSIsInVzZXJJZCIsImNhcmRPd25lcklkIiwiX2Nsb3NlUG9wdXBJbWFnZSIsImNvbmZpcm1hdGlvbiIsImNvbmZpcm1CdXR0b24iLCJvcGVuIiwib3duZXIiLCJfaWQiLCJzZXRFdmVudExpc3RlbmVycyIsIl90aGlzJF9pdGVtJGxpa2VzIiwiX3RoaXMyIiwiZWxlbWVudHNDb250YWluZXIiLCJfZ2V0VGVtcGxhdGUiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJzcmMiLCJhbHQiLCJsaWtlcyIsInNvbWUiLCJsaWtlIiwicHJlcGVuZCIsIlBvcHVwV2l0aEltYWdlIiwidGl0bGVFbGVtZW50IiwiaW1hZ2VFbGVtZW50IiwiX3RpdGxlRWxlbWVudCIsIl9pbWFnZUVsZW1lbnQiLCJsaW5rIiwiUG9wVXBXaXRoRm9ybSIsInN1Ym1pdEZvcm0iLCJzdWJtaXRCdXR0b24iLCJfc3VibWl0Rm9ybSIsIl9zdWJtaXRCdXR0b24iLCJfYnV0dG9uTWVzc2FnZSIsIl9pc0xvYWRpbmciLCJmaXJzdFZhbHVlIiwiY2hpbGRyZW4iLCJzZWNvbmRWYWx1ZSIsIl9zdXBlclByb3BHZXQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJVc2VySW5mbyIsIl9yZWYiLCJuYW1lU2VsZWN0b3IiLCJhYm91dFNlbGVjdG9yIiwiYXZhdGFyU2VsZWN0b3IiLCJfbmFtZUVsZW1lbnQiLCJfYWJvdXRFbGVtZW50IiwiX2F2YXRhckVsZW1lbnQiLCJ1c2VyTmFtZSIsInVzZXJBYm91dCIsIl9yZWYyIiwibmFtZSIsImFib3V0IiwiYXZhdGFyIiwiRm9ybVZhbGlkYXRvciIsImNvbmZpZyIsImZvcm0iLCJfaW5wdXQiLCJpbnB1dCIsIl9pbmFjdGl2ZUJ1dHRvbiIsImluYWN0aXZlQnV0dG9uIiwiX2lucHV0RXJyb3IiLCJpbnB1dEVycm9yIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2Zvcm0iLCJmb3JtRWxlbWVudCIsImVycm9yTWVzc2FnZSIsImVycm9yRWxlbWVudCIsImNvbmNhdCIsImlkIiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oaWRlSW5wdXRFcnJvciIsIl9zaG93SW5wdXRFcnJvciIsInZhbGlkYXRpb25NZXNzYWdlIiwiaW5wdXRMaXN0IiwiaW5wdXRFbGVtZW50IiwiYnV0dG9uIiwiX2hhc0ludmFsaWRJbnB1dCIsImRpc2FibGVkIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsIl9idXR0b25TdGF0ZSIsImZvckVhY2giLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwiU2VjdGlvbiIsIml0ZW1zIiwicmVuZGVyZXIiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJlbGVtZW50IiwiYXBpIiwiQXBpIiwib3B0aW9ucyIsIl9iYXNlVVJMIiwiYmFzZVVybCIsIl9oZWFkZXJzIiwiaGVhZGVycyIsImZldGNoIiwidGhlbiIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImF1dGhvcml6YXRpb24iLCJmb3JtQ3JlYXRlIiwiZm9ybUVkaXQiLCJlZGl0QnV0dG9uIiwiYWRkQnV0dG9uIiwicHJvZmlsZUltYWdlIiwicG9wdXBzIiwidXNlckluZm8iLCJ1c2VyRGF0YSIsImdldFVzZXJJbmZvIiwiZGF0YSIsInNldFVzZXJJbmZvIiwic2V0QXZhdGFyIiwiZ2V0SW5pdGlhbENhcmRzIiwiY2FyZExpc3QiLCJyZXZlcnNlIiwicG9wdXBJbWFnZSIsImNhcmQiLCJsZW5ndGgiLCJoYW5kbGVMaWtlIiwidG9MaWtlIiwicmVzcG9uc2UiLCJzZXRMaWtlc1F1YW50aXR5IiwidG9EaXNsaWtlIiwiY2FyZElkIiwiZGVsZXRlQ2FyZCIsImNhcmRFbGVtZW50IiwiZ2VuZXJhdGVDYXJkIiwidHJhc2hDYW4iLCJhZGRJdGVtIiwiZm9ybUVkaXRWYWxpZGF0b3IiLCJmb3JtQ3JlYXRlVmFsaWRhdG9yIiwiZW5hYmxlVmFsaWRhdGlvbiIsInBvcHVwRm9ybUVkaXQiLCJwcmV2ZW50RGVmYXVsdCIsInNldExvYWRpbmciLCJuYW1lSW5wdXQiLCJqb2JJbnB1dCIsImVkaXRQcm9maWxlIiwicG9wdXBGb3JtQ3JlYXRlIiwidGl0bGVJbnB1dCIsImltYWdlTGlua0lucHV0IiwiYWRkQ2FyZCIsInBvcHVwRm9ybUF2YXRhciIsImF2YXRhckxpbmsiLCJ1cGRhdGVBdmF0YXIiLCJjdXJyZW50VGFyZ2V0Il0sInNvdXJjZVJvb3QiOiIifQ==